<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Nearby Hospitals (Free API)</title>
  <style>
    body { font-family: Arial; padding: 10px; }
    .hospital {
      border: 1px solid #ddd;
      padding: 10px;
      margin-bottom: 8px;
      border-radius: 5px;
    }
  </style>
</head>
<body>

<h2>Nearby Hospitals</h2>
<button onclick="getHospitals()">Find Hospitals Near Me</button>
<div id="status"></div>
<div id="list"></div>

<script>
function getHospitals() {
  document.getElementById("status").innerText = "Getting location...";

  if (!navigator.geolocation) {
    alert("Geolocation not supported");
    return;
  }

  navigator.geolocation.getCurrentPosition(fetchHospitals, errorHandler);
}

async function fetchHospitals(position) {
  const lat = position.coords.latitude;
  const lon = position.coords.longitude;

  document.getElementById("status").innerText = "Fetching nearby hospitals...";

  const query = `
    [out:json][timeout:25];
    (
      node["amenity"="hospital"](around:3000,${lat},${lon});
      way["amenity"="hospital"](around:3000,${lat},${lon});
      relation["amenity"="hospital"](around:3000,${lat},${lon});
    );
    out center tags;
  `;

  const url = "https://overpass-api.de/api/interpreter?data=" +
              encodeURIComponent(query);

  try {
    const response = await fetch(url);
    const data = await response.json();

    showHospitals(data.elements);
  } catch (err) {
    document.getElementById("status").innerText = "Error fetching data";
  }
}

function showHospitals(hospitals) {
  const list = document.getElementById("list");
  list.innerHTML = "";
  document.getElementById("status").innerText =
    `Found ${hospitals.length} hospitals`;

  if (hospitals.length === 0) {
    list.innerHTML = "No hospitals found nearby.";
    return;
  }

  hospitals.forEach(h => {
    const name = h.tags?.name || "Unnamed Hospital";
    const addr = [
      h.tags?.["addr:housenumber"],
      h.tags?.["addr:street"],
      h.tags?.["addr:city"]
    ].filter(Boolean).join(", ");

    const div = document.createElement("div");
    div.className = "hospital";
    div.innerHTML = `<b>${name}</b><br>${addr || "Address not available"}`;
    list.appendChild(div);
  });
}

function errorHandler(error) {
  document.getElementById("status").innerText =
    "Location access denied or unavailable";
}
</script>

</body>
</html>

